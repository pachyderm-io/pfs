{
  "pipeline": {
    "name": "checkpoint"
  },
  "description": "A pipeline that performs image-to-image translation in the `training` mode to output the results in the `checkpoint` repository and then runs the same code in the `export` mode against the results in the `checkpoint` repo to output the model to the `model` repository.",
  "transform": {
    "image": "dwhitena/pix2pix",
    "cmd": [ "/bin/bash" ],
    "stdin": [
      "python pix2pix.py --mode train --output_dir /pfs/out --max_epochs 1 --input_dir /pfs/training --which_direction BtoA",
      "sed -i 's/out/checkpoint/g' /pfs/out/checkpoint"
    ]
  },
  "parallelism_spec": {
    "constant": "1"
  },
  "input": {
    "pfs": {
      "repo": "training",
      "glob": "/"
    }
  }
}
{
  "pipeline": {
    "name": "model"
  },
  "transform": {
    "image": "dwhitena/pix2pix",
    "cmd": [ "/bin/bash" ],
    "stdin": [
      "python pix2pix.py --mode export --output_dir /pfs/out --checkpoint /pfs/checkpoint",
      "sed -i 's/out/model/g' /pfs/out/checkpoint"
    ]
  },
  "parallelism_spec": {
    "constant": "1"
  },
  "input": {
    "pfs": {
      "repo": "checkpoint",
      "glob": "/"
    }
  }
}
